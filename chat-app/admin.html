<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - ChatApp</title>
    
    <!-- ðŸ” CSP FIX FÃœR FONT AWESOME -->
    <meta http-equiv="Content-Security-Policy" content="
    default-src 'self' https://www.gstatic.com https://cdnjs.cloudflare.com https://fonts.googleapis.com https://fonts.gstatic.com;
    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.gstatic.com https://cdnjs.cloudflare.com;
    connect-src 'self' https://*.firebaseio.com https://*.googleapis.com wss:;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com;
    font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com;
    img-src 'self' data: https:;
  ">
  
    
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="admin-container">
        <!-- Admin Header -->
        <div class="admin-header">
            <div class="admin-brand">
                <h1>ðŸ‘‘ Admin Panel</h1>
                <p>ChatApp Management Center</p>
            </div>
            <div class="admin-actions">
                <div class="admin-info">
                    <img id="adminAvatar" src="https://ui-avatars.com/api/?name=Admin&background=9b8cff&color=071020" 
                         alt="Admin" class="avatar">
                    <div>
                        <div style="font-weight: 600;">Administrator</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);" id="adminEmail"></div>
                    </div>
                </div>
                <button onclick="logout()" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
                <a href="dashboard.html" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Zum Chat
                </a>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(100, 210, 255, 0.2);">
                    <i class="fas fa-users" style="color: var(--accent-blue);"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-number" id="totalUsers">0</div>
                    <div class="stat-label">Registrierte User</div>
                </div>
                <div class="stat-trend" id="usersTrend">+0 heute</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(155, 140, 255, 0.2);">
                    <i class="fas fa-comments" style="color: var(--accent-purple);"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-number" id="totalChats">0</div>
                    <div class="stat-label">Aktive Chats</div>
                </div>
                <div class="stat-trend" id="chatsTrend">+0 heute</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(76, 217, 100, 0.2);">
                    <i class="fas fa-message" style="color: var(--success);"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-number" id="totalMessages">0</div>
                    <div class="stat-label">Nachrichten</div>
                </div>
                <div class="stat-trend" id="messagesTrend">+0 heute</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(255, 107, 107, 0.2);">
                    <i class="fas fa-shield-alt" style="color: var(--danger);"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-number" id="onlineNow">0</div>
                    <div class="stat-label">Online jetzt</div>
                </div>
                <div class="stat-trend" id="onlineTrend">ðŸŸ¢ Live</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="admin-main">
            <!-- Left Column -->
            <div class="admin-column">
                <!-- User Management -->
                <div class="admin-card">
                    <div class="card-header">
                        <h3><i class="fas fa-users-cog"></i> User Management</h3>
                        <div class="card-actions">
                            <input type="text" id="userSearch" placeholder="User suchen..." class="search-input">
                            <button onclick="exportUsers()" class="btn btn-secondary btn-sm">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>User</th>
                                        <th>Status</th>
                                        <th>Registriert</th>
                                        <th>Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTable">
                                    <!-- Users werden hier geladen -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- System Logs -->
                <div class="admin-card">
                    <div class="card-header">
                        <h3><i class="fas fa-clipboard-list"></i> System Logs</h3>
                        <button onclick="clearLogs()" class="btn btn-danger btn-sm">
                            <i class="fas fa-trash"></i> LÃ¶schen
                        </button>
                    </div>
                    <div class="card-content">
                        <div class="logs-container" id="systemLogs">
                            <!-- Logs werden hier angezeigt -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="admin-column">
                <!-- Chat Management -->
                <div class="admin-card">
                    <div class="card-header">
                        <h3><i class="fas fa-comments"></i> Chat Management</h3>
                        <button onclick="createGlobalChat()" class="btn btn-primary btn-sm">
                            <i class="fas fa-plus"></i> Global Chat
                        </button>
                    </div>
                    <div class="card-content">
                        <div class="table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>Chat Name</th>
                                        <th>Mitglieder</th>
                                        <th>Ersteller</th>
                                        <th>Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody id="chatsTable">
                                    <!-- Chats werden hier geladen -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- System Control -->
                <div class="admin-card">
                    <div class="card-header">
                        <h3><i class="fas fa-cogs"></i> System Control</h3>
                    </div>
                    <div class="card-content">
                        <div class="control-grid">
                            <div class="control-item">
                                <label>Wartungsmodus</label>
                                <label class="switch">
                                    <input type="checkbox" id="maintenanceMode" onchange="toggleMaintenance()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="control-item">
                                <label>Neue Registrierungen</label>
                                <label class="switch">
                                    <input type="checkbox" id="registrationToggle" checked onchange="toggleRegistrations()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="control-item">
                                <label>Chat Erstellung</label>
                                <label class="switch">
                                    <input type="checkbox" id="chatCreationToggle" checked onchange="toggleChatCreation()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="quick-actions">
                            <h4>Schnellaktionen</h4>
                            <div class="action-buttons">
                                <button onclick="clearAllChats()" class="btn btn-danger btn-sm">
                                    <i class="fas fa-trash"></i> Alle Chats leeren
                                </button>
                                <button onclick="sendGlobalAnnouncement()" class="btn btn-primary btn-sm">
                                    <i class="fas fa-bullhorn"></i> AnkÃ¼ndigung
                                </button>
                                <button onclick="backupSystem()" class="btn btn-secondary btn-sm">
                                    <i class="fas fa-database"></i> Backup
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Monitor -->
                <div class="admin-card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-line"></i> Live Monitor</h3>
                    </div>
                    <div class="card-content">
                        <div class="monitor-stats">
                            <div class="monitor-item">
                                <div class="monitor-label">CPU Auslastung</div>
                                <div class="monitor-value">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="cpuUsage" style="width: 25%"></div>
                                    </div>
                                    <span>25%</span>
                                </div>
                            </div>
                            <div class="monitor-item">
                                <div class="monitor-label">Speicher</div>
                                <div class="monitor-value">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="memoryUsage" style="width: 60%"></div>
                                    </div>
                                    <span>60%</span>
                                </div>
                            </div>
                            <div class="monitor-item">
                                <div class="monitor-label">Datenbank</div>
                                <div class="monitor-value">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="dbUsage" style="width: 45%"></div>
                                    </div>
                                    <span>45%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal fÃ¼r User Details -->
        <div id="userModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3>User Details</h3>
                    <button onclick="closeUserModal()" class="btn-close">&times;</button>
                </div>
                <div class="modal-body" id="userModalContent">
                    <!-- User Details werden hier geladen -->
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase CDN Bundle statt einzelner Scripts -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>